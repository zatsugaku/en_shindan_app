# 縁診断Webアプリ - プロジェクト憲法

## プロジェクト概要

**プロジェクト名:** 縁診断Webアプリ (en_shindan_app)

**目的:**
ユーザーが質問に回答すると、Firestoreに事前保存された診断結果を表示する縁診断Webアプリケーションを開発する。

**コンセプト:**
- ユーザーが複数の質問に回答
- 回答内容を分析し、最適な診断結果を判定
- Firestoreから診断結果を取得して表示
- シンプルで直感的なユーザー体験を提供

---

## 技術スタック

### フロントエンド
- **React** - UIフレームワーク
- **Firebase Hosting** - 静的ファイルホスティング

### バックエンド
- **Firebase Functions** - 診断ロジックの処理
- **Firestore** - 診断結果データの保存・取得

### 開発環境
- **Node.js** - JavaScript実行環境
- **npm/yarn** - パッケージ管理

---

## アーキテクチャ

```
[ユーザー]
    ↓
[React フロントエンド (Firebase Hosting)]
    ↓ (質問への回答を送信)
[Firebase Functions (診断ロジック)]
    ↓ (診断結果IDを判定)
[Firestore (診断結果データ)]
    ↓ (診断結果を返却)
[React フロントエンド (結果表示)]
```

---

## 役割分担

### Claude Code（司令塔）
- **役割:** プロジェクトの計画、設計、レビュー、次のタスクの指示
- **責任範囲:**
  - 高レベルなアーキテクチャ設計
  - コードレビューと品質管理
  - プロジェクト全体の進行管理
  - 重要な技術判断
  - タスクの優先順位付け

### Codex CLI（実作業担当）
- **役割:** 具体的なコード生成とファイル操作
- **利用方法:** MCPツールとして連携
- **責任範囲:**
  - 詳細なコード実装
  - ファイルの作成・編集
  - 定型的なコード生成
  - リファクタリング作業

### 開発方針
**トークン効率化戦略:**
- Claude Codeは高レベルな設計と重要なレビューに集中
- 詳細なコード生成はCodex CLIに委譲
- MCPプロトコルを通じて効率的な連携を実現

---

## MCP連携設定

### Codex CLI MCP サーバー
- **サーバーURL:** `http://127.0.0.1:8000`
- **プロトコル:** JSON-RPC 2.0
- **設定ファイル:** `.mcp.json`

### 利用可能なメソッド
1. **codex_completion** - カスタムプロンプトによるコード生成
2. **write_code** - 言語指定のコード生成
3. **explain_code** - コード解説
4. **debug_code** - デバッグと修正

---

## プロジェクト構成（予定）

```
en_shindan_app/
├── .claude/                 # Claude Code設定
├── .mcp.json               # MCP連携設定
├── CLAUDE.md               # このファイル
├── src/
│   ├── components/         # Reactコンポーネント
│   ├── pages/             # ページコンポーネント
│   └── utils/             # ユーティリティ関数
├── functions/             # Firebase Functions
│   └── index.js           # 診断ロジック
├── firestore.rules        # Firestoreセキュリティルール
├── firebase.json          # Firebase設定
└── package.json           # 依存関係
```

---

## 開発フロー

1. **計画フェーズ**
   - Claude Codeが機能要件を整理
   - アーキテクチャを設計

2. **実装フェーズ**
   - Claude CodeがCodex CLIに実装指示
   - Codex CLIがコードを生成

3. **レビューフェーズ**
   - Claude Codeが生成されたコードをレビュー
   - 必要に応じて修正指示

4. **テストフェーズ**
   - 機能テストと統合テスト
   - バグ修正

---

## 次のステップ

1. Firebase プロジェクトの初期化
2. React アプリケーションのセットアップ
3. Firestore データ構造の設計
4. 質問フローの実装
5. 診断ロジックの実装
6. デプロイとテスト

---

**最終更新:** 2025-11-05
**プロジェクトステータス:** 初期セットアップ完了
