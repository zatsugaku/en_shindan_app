# 設計決定記録（Design Decisions）

このファイルには、縁診断アプリの重要な設計決定とコンセプトを記録します。

---

## 2025-11-18: プロジェクトコンセプトの明確化

### 診断のコンセプト

**基本理念：**
- これは**占い**ではなく、**自己理解と開縁のためのツール**です
- 「当たる・当たらない」ではなく、「自分の特性を知り、活かす」

**縁の捉え方：**
1. **生まれ持った縁の傾向がある** - 60種類の縁プロファイル（五行×自然現象）
2. **自分が好む縁・引き寄せてきた縁もある** - 実際に自分が選んできたパターン
3. **両方を知ることで「自分の場合はどうすると縁が開くのか」が分かる**
4. **それを実践して開縁につなげる**

**重要な注意点：**
- ❌ 「縁があるものだけ大事にする」という排他的な考え方ではない
- ✅ 「生まれ持った傾向 + 自分が好む縁 = 自分の開縁パターンを知る」
- ✅ 縁があるとされていないものから離れるのではなく、自分に合う縁の活かし方を知る

---

## 2025-11-18: 理論構成の整理

### 3つの理論 + バイオリズム分析

**理論的背景（縁を紐解く）：**

1. **理論1: 四柱推命**
   - 1000年以上の歴史を持つ東洋統計学
   - 生年月日から60分類（五行）を決定
   - 基本的なエネルギー特性を解析

2. **理論2: 名前音韻学**
   - 名前の音の響きが持つ力の研究
   - 母音と子音の組み合わせを15要素で分析
   - 3つの縁タイプ（結縁/深縁/広縁）を判定

3. **理論3: 自然現象調和理論**
   - 人間と自然のリズムの関係性
   - 12の自然現象（春霞・夏雨・彩雲・朝日・夕陽・秋風・冬陽・朧月・霜夜・氷刃・春雷・豊穣）
   - それぞれの自然現象と人間の個性の関係を解明

**診断結果コンテンツ（縁を活かす）：**

- 理論1〜3で「あなたの縁のかたち」を紐解く
- その縁（人）特有の**バイオリズム**を分析（10の状態を30-40日周期で巡る）
- バイオリズムは診断結果として提供する情報コンテンツの一部
- 他のコンテンツ: 名前の縁、引き寄せてきた縁のパターン、縁の力を最大化するヒントなど

**重要：** バイオリズムは理論的背景ではなく、診断結果で分かるコンテンツの1つ

---

## 2025-11-18: LPデザインの方向性

### セクション見出しの変更

**変更前（不適切）：**
- ❌ 「なぜ、この診断は『当たる』のか」
  - 理由: 占い的なニュアンスが強すぎる
  - 理由: 「当たる・当たらない」という表現はコンセプトに反する

**変更後（適切）：**
- ✅ **「統計学と古来の智慧が、あなたの縁を紐解く」**
  - 理由: 科学的信頼性（統計学）と伝統的神秘性（古来の智慧）の両方を表現
  - 理由: 占いではなく、理論に基づいた自己理解ツールであることを明確化
  - 理由: 高級感と専門性を保ちながら、神秘的な世界観も維持

### デザイン方針

**高級感と神秘性の両立：**

1. **配色**
   - ディープパープル (#2d1b4e, #1a0f2e) - 神秘性・精神性
   - ゴールド (#c9a961, #a08445) - 高級感・特別感
   - 落ち着いたベージュ (#e0d5c7) - 伝統・上品さ

2. **フォント**
   - 游明朝（Yu Mincho） - 高級感・専門性・日本的な美しさ
   - 広い文字間隔（letter-spacing） - ゆったりとした上品な読み心地

3. **レイアウト**
   - 角丸なし（border-radius: 0） - モダンでシャープな印象
   - 広い余白 - 贅沢な空間使い
   - 繊細なシャドウ - 控えめで品のある陰影

4. **絵文字の使用**
   - ❌ 絵文字は使用しない
   - 理由: カジュアルで軽い印象になり、高級感・専門性が損なわれる
   - 代わりに: シンプルで洗練されたテキスト表現

---

---

## 2025-11-18: 診断フロー実装方針の決定

### 実装パターン：ハイブリッド方式（パターンC）

**選択理由：**
- ユーザー体験の軽さ（即座に結果表示）
- ビジネス価値（メールアドレス任意取得、アクセス記録）
- コスト最小（月$1未満）
- 柔軟性（段階的に厳格化可能）

### アーキテクチャ

```
[ユーザー入力（11項目）]
  ↓
[React: 診断計算（フロントエンド）]
  ↓
[Firebase Functions: トークン生成＋記録]
  - reCAPTCHA v3検証
  - アクセストークン生成（UUID）
  - Firestore軽量記録
  - メール送信（任意）
  ↓
[即座にリダイレクト]
/results/01_火/火の朧月.html?token=xxx
  ↓
[結果ページ: トークン検証]
  - トークンあり: 正規アクセス（記録）
  - トークンなし: Phase 1は表示（記録のみ）
```

### 段階的実装計画

**Phase 1（初期ローンチ）:**
- トークンなしでも結果表示
- 直接アクセスを記録のみ
- メールアドレス入力は任意

**Phase 2（運用後）:**
- トークンなしは警告バナー表示
- 「正規診断を受けてください」CTA

**Phase 3（必要に応じて）:**
- トークンなしは完全ブロック
- 診断ページへリダイレクト

### コスト試算

**月1,000診断の場合：**
- Firebase Functions実行: $0.10
- Firestore書き込み/読み込み: $0.03
- SendGrid（無料枠内）: $0
- **合計: 約$0.13/月**

**月10,000診断の場合：**
- Firebase Functions実行: $1.00
- Firestore書き込み/読み込み: $0.30
- SendGrid（無料枠内）: $0
- **合計: 約$1.30/月**

### 技術スタック

**フロントエンド：**
- React
- 診断ロジック実装（JavaScript）
- reCAPTCHA v3

**バックエンド：**
- Firebase Functions（Node.js）
- Firestore（軽量記録）
- Firebase Extensions: Trigger Email（SendGrid連携）

### セキュリティ

- reCAPTCHA v3でボット対策
- トークン有効期限24時間
- 個人情報はFirestoreに保存しない（診断結果とメールのみ）

---

## 次回以降の決定事項

このセクションには、今後の重要な設計決定を追記していきます。
