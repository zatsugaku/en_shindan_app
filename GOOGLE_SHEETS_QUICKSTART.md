# Google Sheets連携 クイックスタートガイド

## 🎯 完成形の動作フロー

```
【ユーザー側】
diagnose.html で診断フォーム入力
    ↓
フロントエンドで診断計算（即座に）
    ↓
診断結果 + ユーザー情報 → Googleスプレッドシート
    ↓
diagnosis-submitted.html 表示
「24時間以内にメールをお送りします」

━━━━━━━━━━━━━━━━━━━━━━━━━━

【あなた側】
Googleスプレッドシート を開く
    ↓
新規申し込みを確認（R列が空白）
    ↓
各行に診断結果が既に表示されている ✨
| お名前 | メアド | 診断結果 | 送信ステータス |
| 山田太郎 | xxx@... | 火の朧月 | (空白) |
    ↓
「メール送信」ボタンをクリック
    ↓
Gmail から診断結果メール送信 📧
    ↓
R列に「送信済み」マーク
```

---

## 📋 スプレッドシートの構造

### ヘッダー行（A1〜T1）

| 列 | ヘッダー名 | 内容 |
|----|-----------|------|
| A  | タイムスタンプ | 申し込み日時（自動） |
| B  | お名前 | 山田 太郎 |
| C  | 名前（ローマ字） | Taro |
| D  | 苗字（ローマ字） | Yamada |
| E  | 生年月日 | 1990-01-01 |
| F  | 出生地 | 東京都 |
| G  | 現在地 | 神奈川県 |
| H  | 質問1 | 木 |
| I  | 質問2 | 火 |
| J  | 質問3 | 土 |
| K  | 質問4 | 金 |
| L  | メールアドレス | user@example.com |
| **M**  | **診断結果** | **火の朧月**（重要！） |
| N  | フォルダ名 | fire |
| O  | ファイル名 | fire-oborozuki |
| P  | 名前の縁 | 結縁 |
| Q  | 引き寄せた縁 | 木縁型 |
| R  | 送信ステータス | 送信済み（メール送信後） |
| S  | 送信日時 | 2025-11-20...（メール送信後） |
| T  | 結果URL | https://...（メール送信後） |

**M列の「診断結果」を見れば、すぐに何を送信するか分かります！**

---

## 🚀 セットアップ（5ステップ）

### Step 1: 専用Gmailアカウント作成

1. https://accounts.google.com/signup
2. 新規アカウント作成
   - 例: `enguide.shindan@gmail.com`
   - 名前: **縁診断 運営チーム**

---

### Step 2: Googleスプレッドシート作成

1. https://sheets.google.com
2. **空白のスプレッドシート**作成
3. 名前: **縁診断 申し込み管理**
4. A1セルから上記のヘッダーを入力

---

### Step 3: Apps Script設定

1. メニュー: **拡張機能** → **Apps Script**
2. `scripts/google-apps-script-web-receiver.js` の内容を全てコピー＆ペースト
3. **保存**
4. **デプロイ** → **新しいデプロイ**
5. 種類: **ウェブアプリ**
6. アクセスできるユーザー: **全員**（重要！）
7. **デプロイ**
8. **WebアプリURL** をコピー
   ```
   例: https://script.google.com/macros/s/AKfycby.../exec
   ```

---

### Step 4: フロントエンド設定

1. `public/free/js/diagnose-v3.js` を開く
2. 7行目を更新:
   ```javascript
   const GOOGLE_APPS_SCRIPT_URL = 'ここに先ほどのURLを貼り付け';
   ```
3. `public/free/diagnose.html` を開く
4. 355行目付近を更新:
   ```html
   <!-- 変更前 -->
   <script type="module" src="js/diagnose.js"></script>

   <!-- 変更後 -->
   <script type="module" src="js/diagnose-v3.js"></script>
   ```

---

### Step 5: テスト

1. `diagnose.html` をブラウザで開く
2. テストデータで診断申し込み
3. Googleスプレッドシートを確認
4. **M列に診断結果が表示されている！**
5. 2行目を選択 → メニュー: **縁診断** → **選択行の診断を実行してメール送信**
6. メール受信確認

---

## 📊 データの見方

### 未送信の申し込み

R列（送信ステータス）が**空白**の行が未送信です。

```
| お名前 | メアド | 診断結果 | 送信ステータス |
|--------|--------|---------|---------------|
| 山田太郎 | xxx@... | 火の朧月 | (空白) ← 未送信 |
| 佐藤花子 | yyy@... | 木の春霞 | 送信済み     |
```

---

## 🔧 日常の運用（超簡単）

### 毎日の作業（所要時間: 2-5分）

1. **Googleスプレッドシートを開く**
2. **R列が空白の行を確認**（新規申し込み）
3. **M列で診断結果を確認**
4. **メニュー: 縁診断 → 未送信の全診断を一括送信** クリック
5. **完了！**

または個別送信:
- 各行を選択
- メニュー: **縁診断** → **選択行の診断を実行してメール送信**

---

## ✨ このシステムの利点

### あなた側:
✅ **診断結果が既に見える**（M列）
✅ **送信前に内容確認できる**
✅ **クリック1回で送信**（半自動）
✅ **完全無料**（1日100通まで）
✅ **到達率100%**（Gmail送信）
✅ **メアド100%取得**

### ユーザー側:
✅ **入力してすぐに「受付完了」画面**
✅ **24時間以内にメール受信**
✅ **シンプルな体験**

---

## 🎉 完了！

詳細なセットアップ手順は `SETUP_GOOGLE_SHEETS.md` を参照してください。
