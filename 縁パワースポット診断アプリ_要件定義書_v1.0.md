# 縁パワースポット診断アプリ 要件定義書 v1.0

**作成日**: 2025-11-09  
**対象**: Claude Code実装用  
**システム名**: 縁パワースポット診断 無料診断Webアプリケーション  
**バージョン**: v3.1.2準拠

---

## 📋 目次

1. [プロジェクト概要](#1-プロジェクト概要)
2. [システム要件](#2-システム要件)
3. [機能要件](#3-機能要件)
4. [技術仕様](#4-技術仕様)
5. [データ構造](#5-データ構造)
6. [UI/UX仕様](#6-uiux仕様)
7. [実装フェーズ](#7-実装フェーズ)
8. [品質基準](#8-品質基準)
9. [参照資料](#9-参照資料)

---

## 1. プロジェクト概要

### 1.1 目的
統計学的根拠（四柱推命・名前音韻学・自然現象調和理論・バイオリズム）に基づく「縁の統合分析システム」により、個人の縁プロファイルを診断し、無料体験版として提供するWebアプリケーション。

### 1.2 ターゲットユーザー
- パワースポット・開運に興味がある一般ユーザー
- 占い・スピリチュアルサービスを求める人
- 自己理解・自己啓発に関心のある人

### 1.3 提供価値
- **60分類システム**による精密な個人タイプ判定
- **統計学的根拠**に基づく信頼性の高い診断
- **無料**で本格的な縁プロファイル分析を体験
- **3,000-4,000字**の詳細な診断結果

### 1.4 制約事項（無料版）
- パワースポット情報は**提供しない**（有料版の差別化）
- データベース連携は**不要**
- AI生成は**使用しない**（テンプレート方式）
- 完全クライアントサイドで動作

---

## 2. システム要件

### 2.1 動作環境
```yaml
プラットフォーム:
  - Webブラウザ（Chrome, Firefox, Safari, Edge）
  - モバイルブラウザ対応（レスポンシブ）

動作方式:
  - 完全クライアントサイド（Single Page Application）
  - サーバー不要
  - 外部API不要

推奨環境:
  - 画面解像度: 375px以上（スマートフォン）
  - JavaScript有効
  - Cookie・LocalStorage利用可能
```

### 2.2 技術スタック
```yaml
フロントエンド:
  - HTML5
  - Tailwind CSS（coreクラスのみ）
  - Vanilla JavaScript（フレームワーク不要）

デプロイ:
  - 静的ホスティング（Firebase Hosting等）
  - CDN対応

開発:
  - Node.js環境（開発用）
  - ビルドツール不要
```

### 2.3 性能要件
```yaml
処理速度:
  - 診断計算: < 1秒
  - 結果表示: < 2秒
  - ページ読込: < 3秒

品質:
  - エラー率: < 0.1%
  - 計算精度: 100%
  - UI応答性: < 200ms
```

---

## 3. 機能要件

### 3.1 入力フォーム機能

#### 3.1.1 必須入力項目（11項目）
```typescript
interface UserInput {
  // 基本情報（5項目）
  birthDate: string;           // 生年月日（YYYY-MM-DD）
  firstName: string;           // 名前（ローマ字）
  lastName: string;            // 苗字（ローマ字）
  birthPrefecture: string;     // 生まれた都道府県
  currentPrefecture: string;   // 現在住んでいる都道府県（追加）
  
  // 五行縁型診断質問（4項目）
  question1: GogyouType;       // 仕事・活動パターン
  question2: GogyouType;       // 休日の過ごし方
  question3: GogyouType;       // 人間関係での役割
  question4: GogyouType;       // ストレス対処法
  
  // 名前音韻選択（自動判定→手動修正可能）
  nameType: NameType;          // 結縁/深縁/広縁
  
  // 診断日（自動取得）
  diagnosisDate: Date;         // 診断実行日
}

type GogyouType = '木' | '火' | '土' | '金' | '水';
type NameType = '結縁' | '深縁' | '広縁';
```

#### 3.1.2 入力フォームUI要件
```yaml
レイアウト:
  - セクション分割（基本情報・診断質問・確認）
  - ステップ表示（1/3 → 2/3 → 3/3）
  - プログレスバー表示

バリデーション:
  - リアルタイム入力チェック
  - エラーメッセージ表示
  - 必須項目の視覚的表示

ユーザビリティ:
  - 都道府県選択（ドロップダウン）
  - 日付入力（カレンダーピッカー）
  - ラジオボタン（診断質問）
  - ヘルプテキスト・例示
```

### 3.2 診断計算機能

#### 3.2.1 60分類×12位置計算
```javascript
/**
 * 生年月日から60分類と12位置を算出
 * @param {Date} birthDate - 生年月日
 * @returns {Object} { naturalType, position, element, phenomena }
 */
function calculate60Classification(birthDate) {
  // 1. 基準日からの経過日数計算
  const baseDate = new Date('1900-01-01');
  const daysSince = Math.floor((birthDate - baseDate) / (1000 * 60 * 60 * 24));
  
  // 2. 自然現象の決定（12種類）
  const phenomena = PHENOMENA_MAP[daysSince % 12];
  
  // 3. 五行の決定（5種類）
  const elementIndex = Math.floor(daysSince / 60) % 5;
  const element = GOGYOU_LIST[elementIndex];
  
  // 4. 60分類の組み立て
  const naturalType = `${element}の${phenomena}`;
  
  // 5. 12位置へのマッピング
  const position = POSITION_MAPPING[phenomena];
  
  return {
    naturalType,    // "木の春霞"
    position,       // 1-12
    element,        // "木"
    phenomena       // "春霞"
  };
}

// 定数定義
const PHENOMENA_MAP = [
  "春霞", "夏雨", "彩雲", "朝日", "夕陽", "秋風",
  "冬陽", "朧月", "霜夜", "氷刃", "春雷", "豊穣"
];

const GOGYOU_LIST = ["木", "火", "土", "金", "水"];

const POSITION_MAPPING = {
  "春霞": 1, "夏雨": 2, "彩雲": 3, "朝日": 4,
  "夕陽": 5, "秋風": 6, "冬陽": 7, "朧月": 8,
  "霜夜": 9, "氷刃": 10, "春雷": 11, "豊穣": 12
};
```

#### 3.2.2 名前音韻分析
```javascript
/**
 * 名前のローマ字から音韻タイプを判定
 * @param {string} firstName - 名前
 * @param {string} lastName - 苗字
 * @returns {string} '結縁' | '深縁' | '広縁'
 */
function analyzeNameAcoustic(firstName, lastName) {
  const fullName = (firstName + lastName).toLowerCase();
  
  // 母音の種類と出現回数
  const vowels = fullName.match(/[aiueo]/g) || [];
  const uniqueVowels = new Set(vowels);
  const vowelCount = vowels.length;
  const uniqueVowelCount = uniqueVowels.size;
  
  // 母音の多様性率
  const diversity = uniqueVowelCount / vowelCount;
  
  // 判定ロジック
  if (diversity >= 0.8) {
    return '広縁';  // 多様な音韻 → 広い縁
  } else if (diversity >= 0.5) {
    return '深縁';  // 中程度の多様性 → 深い縁
  } else {
    return '結縁';  // 繰り返しの音韻 → 結ばれる縁
  }
}
```

#### 3.2.3 五行縁型判定
```javascript
/**
 * 4つの診断質問から五行縁型を判定
 * @param {Object} answers - { q1, q2, q3, q4 }
 * @returns {Object} { attractionType, elementCounts }
 */
function determineFiveElementType(answers) {
  const { q1, q2, q3, q4 } = answers;
  const elements = [q1, q2, q3, q4];
  
  // 各五行の出現回数
  const counts = {
    '木': 0,
    '火': 0,
    '土': 0,
    '金': 0,
    '水': 0
  };
  
  elements.forEach(element => {
    counts[element]++;
  });
  
  // 最も多い五行を決定
  const dominantElement = Object.entries(counts)
    .sort(([,a], [,b]) => b - a)[0][0];
  
  return {
    attractionType: dominantElement + '縁型',
    elementCounts: counts,
    dominantElement: dominantElement
  };
}
```

#### 3.2.4 バイオリズム計算
```javascript
/**
 * 診断日時点のバイオリズム状態を計算
 * @param {Date} birthDate - 生年月日
 * @param {Date} currentDate - 診断日
 * @returns {Object} バイオリズム情報
 */
function calculateBiorhythm(birthDate, currentDate) {
  // 生まれてからの総日数
  const totalDays = Math.floor((currentDate - birthDate) / (1000 * 60 * 60 * 24));
  
  // 10状態サイクル（約335日周期）
  const BIORHYTHM_STATES = [
    { name: "新生期", duration: 32, energy: "始まり" },
    { name: "発展期", duration: 35, energy: "拡張" },
    { name: "充実期", duration: 38, energy: "最大" },
    { name: "安定期", duration: 33, energy: "安定" },
    { name: "転換期", duration: 29, energy: "変化" },
    { name: "調整期", duration: 31, energy: "調整" },
    { name: "深化期", duration: 36, energy: "深化" },
    { name: "収束期", duration: 34, energy: "収束" },
    { name: "沈静期", duration: 30, energy: "静寂" },
    { name: "準備期", duration: 37, energy: "準備" }
  ];
  
  const cycleLength = BIORHYTHM_STATES.reduce((sum, s) => sum + s.duration, 0);
  const daysInCycle = totalDays % cycleLength;
  
  // 現在の状態を特定
  let accumulatedDays = 0;
  let currentState = null;
  let daysIntoState = 0;
  
  for (const state of BIORHYTHM_STATES) {
    if (daysInCycle < accumulatedDays + state.duration) {
      currentState = state;
      daysIntoState = daysInCycle - accumulatedDays;
      break;
    }
    accumulatedDays += state.duration;
  }
  
  const progress = Math.floor((daysIntoState / currentState.duration) * 100);
  
  return {
    currentState: currentState.name,
    energy: currentState.energy,
    progress: progress,
    daysIntoState: daysIntoState,
    totalDaysInState: currentState.duration
  };
}
```

#### 3.2.5 地域エネルギー補正
```javascript
/**
 * 出生地と現在地の地域エネルギーを計算
 * @param {string} birthPrefecture - 生まれた都道府県
 * @param {string} currentPrefecture - 現在の都道府県
 * @returns {Object} 地域エネルギー情報
 */
function calculateRegionEnergy(birthPrefecture, currentPrefecture) {
  // 都道府県→地域→五行のマッピング（簡略版）
  const PREFECTURE_TO_REGION = {
    '北海道': '北海道',
    '青森県': '東北', '岩手県': '東北', '宮城県': '東北',
    '秋田県': '東北', '山形県': '東北', '福島県': '東北',
    '東京都': '関東', '神奈川県': '関東', '埼玉県': '関東',
    '千葉県': '関東', '茨城県': '関東', '栃木県': '関東', '群馬県': '関東',
    '京都府': '関西', '大阪府': '関西', '兵庫県': '関西',
    // ... 他の都道府県
  };
  
  const REGION_TO_ELEMENT = {
    '北海道': '水',
    '東北': '木',
    '関東': '火',
    '中部': '土',
    '関西': '金',
    '中国': '土',
    '四国': '木',
    '九州': '火',
    '沖縄': '水'
  };
  
  const birthRegion = PREFECTURE_TO_REGION[birthPrefecture];
  const currentRegion = PREFECTURE_TO_REGION[currentPrefecture];
  
  return {
    birthElement: REGION_TO_ELEMENT[birthRegion],
    currentElement: REGION_TO_ELEMENT[currentRegion],
    birthRegion: birthRegion,
    currentRegion: currentRegion
  };
}
```

### 3.3 診断結果生成機能

#### 3.3.1 テンプレート選択ロジック
```javascript
/**
 * 60分類に対応するテンプレートを取得
 * @param {string} naturalType - "木の春霞"等
 * @returns {Object} テンプレートデータ
 */
function getTemplateData(naturalType) {
  // 事前作成された60個のテンプレートから選択
  const template = DIAGNOSIS_TEMPLATES[naturalType];
  
  if (!template) {
    throw new Error(`Template not found for ${naturalType}`);
  }
  
  return template;
}

// テンプレートデータ構造（v2.3準拠）
const DIAGNOSIS_TEMPLATES = {
  "木の春霞": {
    introduction: "導入段落（200-300字）",
    section1: {
      title: "あなたの縁の本質",
      content: "詳細内容（1,500字）"
    },
    section2: {
      title: "縁を活かす場所と人",
      content: "詳細内容（1,500字）"
    },
    section3: {
      title: "今日からできること",
      content: "実践的アドバイス（1,000字）"
    },
    // 軽く触れる情報（有料版への誘導）
    briefInfo: {
      nameType: "あなたは{タイプ}です（50字）",
      attractionType: "あなたは{縁型}です（50字）",
      biorhythm: "現在は{状態}です（50字）",
      regionEnergy: "{元素}のエネルギーの地域（50字）"
    }
  },
  // ... 他59分類
};
```

#### 3.3.2 個人化処理
```javascript
/**
 * テンプレートに個人データを適用
 * @param {Object} template - テンプレートデータ
 * @param {Object} userProfile - ユーザープロファイル
 * @returns {Object} 個人化された診断結果
 */
function personalizeTemplate(template, userProfile) {
  const {
    naturalType,
    position,
    element,
    phenomena,
    nameType,
    attractionType,
    biorhythm,
    regionEnergy
  } = userProfile;
  
  // プレースホルダー置換
  const personalizedContent = {
    introduction: template.introduction
      .replace('{naturalType}', naturalType)
      .replace('{position}', position)
      .replace('{nameType}', nameType),
    
    section1: {
      title: template.section1.title,
      content: template.section1.content
        .replace('{element}', element)
        .replace('{phenomena}', phenomena)
        .replace('{naturalType}', naturalType)
    },
    
    section2: {
      title: template.section2.title,
      content: template.section2.content
        .replace('{attractionType}', attractionType)
        .replace('{dominantElement}', userProfile.dominantElement)
    },
    
    section3: {
      title: template.section3.title,
      content: template.section3.content
        .replace('{biorhythmState}', biorhythm.currentState)
        .replace('{biorhythmEnergy}', biorhythm.energy)
        .replace('{biorhythmProgress}', biorhythm.progress)
    },
    
    conclusion: template.conclusion
      .replace('{naturalType}', naturalType)
  };
  
  return personalizedContent;
}
```

### 3.4 結果表示機能

#### 3.4.1 表示セクション構成
```yaml
診断結果レポート構成（3セクション+導入、合計約5,000字：4,800-5,300字）:

【メインコンテンツ】
1. 導入段落（200-300字）:
   - あなたの縁プロファイル概要
   - 「あなたは{自然タイプ}です」
   - {位置}番の位置の簡潔な説明
   
2. あなたの縁の本質（1,500字）:
   - 60分類の詳細解説
   - 五行エネルギーの特性
   - 自然現象の意味
   - 12位置の影響
   - あなたの生まれ持った縁の特徴
   
3. 縁を活かす場所と人（1,500字）:
   - 相性の良い環境・場所の傾向（抽象的）
   - 縁のある人のタイプ
   - 人間関係での活かし方
   - ライフスタイルとの関連
   
4. 今日からできること（1,000字）:
   - 日常での実践方法
   - 縁を育てる具体的な習慣
   - 心構えとアドバイス
   - 機会の活かし方

【軽く触れる情報（有料版への誘導として）】
- 名前音韻: 「あなたは{結縁/深縁/広縁}タイプです」（50字程度）
- 五行縁型: 「あなたは{木/火/土/金/水}縁型です」（50字程度）
- バイオリズム: 「現在は{状態}（{エネルギー}）です」（50字程度）
- 地域エネルギー: 「{元素}のエネルギーを持つ地域で生まれました」（50字程度）

【完全除外情報（有料版限定）】
❌ 具体的なパワースポット18箇所
❌ 詳細な訪問時期・参拝方法
❌ 年間バイオリズムカレンダー（詳細）
❌ 地域エネルギーの詳細分析・補正計算
❌ 季節別の詳細戦略
❌ 目的別スポット推薦（金運・恋愛・健康等）
```

#### 3.4.2 CTA（Call To Action）
```yaml
有料版への誘導:
  - 位置: 診断結果の末尾
  - 内容:
    - 18箇所のパワースポット情報
    - 訪問時期・参拝方法
    - 年間バイオリズムカレンダー
    - 詳細な開運アドバイス
  - ボタン: "完全版診断を見る"
```

---

## 4. 技術仕様

### 4.1 ファイル構成
```
project-root/
├── index.html              # メインHTML
├── css/
│   └── styles.css          # Tailwind CSS（CDN利用）
├── js/
│   ├── app.js              # アプリケーションメイン
│   ├── calculator.js       # 診断計算ロジック
│   ├── templates.js        # 60分類テンプレート
│   ├── constants.js        # 定数定義
│   └── utils.js            # ユーティリティ関数
├── data/
│   ├── prefecture-map.json # 都道府県マッピング
│   └── biorhythm-states.json # バイオリズム定義
└── README.md               # 説明文書
```

### 4.2 主要モジュール

#### 4.2.1 app.js（アプリケーション制御）
```javascript
/**
 * アプリケーションメインコントローラー
 */
class DiagnosisApp {
  constructor() {
    this.currentStep = 1;
    this.userInput = {};
    this.diagnosisResult = null;
    
    this.init();
  }
  
  init() {
    this.setupEventListeners();
    this.loadSavedData();
  }
  
  setupEventListeners() {
    // フォーム送信
    document.getElementById('diagnosis-form')
      .addEventListener('submit', (e) => this.handleSubmit(e));
    
    // ステップ移動
    document.querySelectorAll('.next-step')
      .forEach(btn => btn.addEventListener('click', () => this.nextStep()));
    
    // リアルタイムバリデーション
    document.querySelectorAll('input, select')
      .forEach(input => input.addEventListener('blur', (e) => this.validateField(e.target)));
  }
  
  async handleSubmit(e) {
    e.preventDefault();
    
    // 入力データ取得
    this.userInput = this.collectFormData();
    
    // バリデーション
    if (!this.validateAll()) {
      return;
    }
    
    // 診断実行
    this.showLoading();
    this.diagnosisResult = await this.executeDiagnosis(this.userInput);
    this.hideLoading();
    
    // 結果表示
    this.displayResult(this.diagnosisResult);
  }
  
  executeDiagnosis(userInput) {
    // 各種計算を実行
    const classification = calculate60Classification(new Date(userInput.birthDate));
    const nameType = analyzeNameAcoustic(userInput.firstName, userInput.lastName);
    const attractionType = determineFiveElementType({
      q1: userInput.question1,
      q2: userInput.question2,
      q3: userInput.question3,
      q4: userInput.question4
    });
    const biorhythm = calculateBiorhythm(
      new Date(userInput.birthDate),
      new Date()
    );
    const regionEnergy = calculateRegionEnergy(
      userInput.birthPrefecture,
      userInput.currentPrefecture
    );
    
    // ユーザープロファイル作成
    const userProfile = {
      ...classification,
      nameType,
      ...attractionType,
      biorhythm,
      regionEnergy
    };
    
    // テンプレート取得と個人化
    const template = getTemplateData(classification.naturalType);
    const personalizedResult = personalizeTemplate(template, userProfile);
    
    return {
      userProfile,
      content: personalizedResult
    };
  }
}

// アプリケーション起動
document.addEventListener('DOMContentLoaded', () => {
  window.app = new DiagnosisApp();
});
```

#### 4.2.2 calculator.js（計算ロジック集約）
```javascript
/**
 * 診断計算関数群
 */

// 60分類計算
export function calculate60Classification(birthDate) { /* ... */ }

// 名前音韻分析
export function analyzeNameAcoustic(firstName, lastName) { /* ... */ }

// 五行縁型判定
export function determineFiveElementType(answers) { /* ... */ }

// バイオリズム計算
export function calculateBiorhythm(birthDate, currentDate) { /* ... */ }

// 地域エネルギー計算
export function calculateRegionEnergy(birthPref, currentPref) { /* ... */ }
```

#### 4.2.3 templates.js（テンプレートデータ）
```javascript
/**
 * 60分類テンプレート定義
 */
export const DIAGNOSIS_TEMPLATES = {
  "木の春霞": {
    introduction: `
あなたの縁は「木の春霞」。
{position}番の位置に生まれたあなたは...
    `,
    section1: {
      title: "生まれ持った縁の本質",
      content: `
{element}のエネルギーと{phenomena}の性質を持つあなたの縁は...
      `
    },
    // ... 他セクション
  },
  // ... 他59分類（全60個）
};
```

#### 4.2.4 constants.js（定数定義）
```javascript
/**
 * システム全体で使用する定数
 */

export const PHENOMENA_MAP = [
  "春霞", "夏雨", "彩雲", "朝日", "夕陽", "秋風",
  "冬陽", "朧月", "霜夜", "氷刃", "春雷", "豊穣"
];

export const GOGYOU_LIST = ["木", "火", "土", "金", "水"];

export const POSITION_MAPPING = {
  "春霞": 1, "夏雨": 2, "彩雲": 3, "朝日": 4,
  "夕陽": 5, "秋風": 6, "冬陽": 7, "朧月": 8,
  "霜夜": 9, "氷刃": 10, "春雷": 11, "豊穣": 12
};

export const PREFECTURE_LIST = [
  '北海道',
  '青森県', '岩手県', '宮城県', '秋田県', '山形県', '福島県',
  // ... 全47都道府県
];

export const BIORHYTHM_STATES = [
  { name: "新生期", duration: 32, energy: "始まり" },
  { name: "発展期", duration: 35, energy: "拡張" },
  { name: "充実期", duration: 38, energy: "最大" },
  { name: "安定期", duration: 33, energy: "安定" },
  { name: "転換期", duration: 29, energy: "変化" },
  { name: "調整期", duration: 31, energy: "調整" },
  { name: "深化期", duration: 36, energy: "深化" },
  { name: "収束期", duration: 34, energy: "収束" },
  { name: "沈静期", duration: 30, energy: "静寂" },
  { name: "準備期", duration: 37, energy: "準備" }
];
```

---

## 5. データ構造

### 5.1 ユーザー入力データ
```typescript
interface UserInput {
  birthDate: string;          // "1990-05-15"
  firstName: string;          // "Taro"
  lastName: string;           // "Yamada"
  birthPrefecture: string;    // "東京都"
  currentPrefecture: string;  // "神奈川県"
  question1: GogyouType;      // "木"
  question2: GogyouType;      // "火"
  question3: GogyouType;      // "土"
  question4: GogyouType;      // "金"
}
```

### 5.2 診断結果データ
```typescript
interface DiagnosisResult {
  userProfile: {
    // 60分類データ
    naturalType: string;      // "木の春霞"
    position: number;         // 1-12
    element: string;          // "木"
    phenomena: string;        // "春霞"
    
    // 名前音韻
    nameType: string;         // "結縁"/"深縁"/"広縁"
    
    // 五行縁型
    attractionType: string;   // "木縁型"
    dominantElement: string;  // "木"
    elementCounts: {
      木: number,
      火: number,
      土: number,
      金: number,
      水: number
    },
    
    // バイオリズム
    biorhythm: {
      currentState: string,   // "新生期"
      energy: string,         // "始まり"
      progress: number,       // 0-100
      daysIntoState: number,
      totalDaysInState: number
    },
    
    // 地域エネルギー
    regionEnergy: {
      birthElement: string,   // "火"
      currentElement: string, // "火"
      birthRegion: string,    // "関東"
      currentRegion: string   // "関東"
    }
  },
  
  content: {
    introduction: string,     // 導入文
    section1: {
      title: string,
      content: string
    },
    section2: {
      title: string,
      content: string
    },
    section3: {
      title: string,
      content: string
    },
    conclusion: string
  },
  
  metadata: {
    diagnosisDate: Date,
    systemVersion: string,    // "v3.1.2"
    calculationTime: number   // ms
  }
}
```

---

## 6. UI/UX仕様

### 6.1 カラーパレット
```css
/* 五行カラーシステム */
:root {
  /* 木: 成長・拡大 */
  --color-wood: #10b981;
  
  /* 火: 活発・情熱 */
  --color-fire: #ef4444;
  
  /* 土: 安定・調和 */
  --color-earth: #f59e0b;
  
  /* 金: 純粋・高品質 */
  --color-metal: #8b5cf6;
  
  /* 水: 柔軟・深遠 */
  --color-water: #3b82f6;
  
  /* 背景グラデーション */
  --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  
  /* テキスト */
  --color-text-primary: #1f2937;
  --color-text-secondary: #6b7280;
  
  /* カード */
  --color-card-bg: #ffffff;
  --color-card-shadow: rgba(0, 0, 0, 0.1);
}
```

### 6.2 レイアウト
```yaml
コンテナ:
  max-width: 800px
  padding: 20px
  margin: 0 auto

カード:
  background: white
  border-radius: 12px
  box-shadow: 0 4px 6px rgba(0,0,0,0.1)
  padding: 24px

レスポンシブ:
  モバイル: < 640px
  タブレット: 640px - 1024px
  デスクトップ: > 1024px
```

### 6.3 画面遷移フロー
```
[スタート画面]
    ↓
[入力フォーム - Step 1/3: 基本情報]
    ↓
[入力フォーム - Step 2/3: 診断質問]
    ↓
[入力フォーム - Step 3/3: 確認]
    ↓
[ローディング画面]
    ↓
[診断結果表示]
    ↓
[CTA: 完全版診断へ]
```

### 6.4 コンポーネント

#### 6.4.1 入力フォーム
```html
<!-- Step 1: 基本情報 -->
<div class="form-step" data-step="1">
  <h2>基本情報を入力してください</h2>
  
  <!-- 生年月日 -->
  <div class="form-group">
    <label for="birthDate">生年月日</label>
    <input type="date" id="birthDate" required>
    <p class="help-text">あなたの生まれた日を選択してください</p>
  </div>
  
  <!-- 名前 -->
  <div class="form-group">
    <label for="firstName">名前（ローマ字）</label>
    <input type="text" id="firstName" placeholder="Taro" required>
    <p class="help-text">例: Taro, Hanako</p>
  </div>
  
  <!-- 苗字 -->
  <div class="form-group">
    <label for="lastName">苗字（ローマ字）</label>
    <input type="text" id="lastName" placeholder="Yamada" required>
    <p class="help-text">例: Yamada, Tanaka</p>
  </div>
  
  <!-- 生まれた都道府県 -->
  <div class="form-group">
    <label for="birthPrefecture">生まれた都道府県</label>
    <select id="birthPrefecture" required>
      <option value="">選択してください</option>
      <option value="北海道">北海道</option>
      <!-- ... 全47都道府県 -->
    </select>
  </div>
  
  <!-- 現在住んでいる都道府県 -->
  <div class="form-group">
    <label for="currentPrefecture">現在住んでいる都道府県</label>
    <select id="currentPrefecture" required>
      <option value="">選択してください</option>
      <option value="北海道">北海道</option>
      <!-- ... 全47都道府県 -->
    </select>
  </div>
  
  <button type="button" class="btn-next">次へ</button>
</div>

<!-- Step 2: 診断質問 -->
<div class="form-step" data-step="2" style="display:none;">
  <h2>あなたの縁のパターンを診断</h2>
  
  <!-- 質問1 -->
  <div class="form-group">
    <label>仕事や主な活動について、最も当てはまるものは？</label>
    <div class="radio-group">
      <label>
        <input type="radio" name="question1" value="木">
        🌱 新しいことを学んだり、人とのつながりを広げる
      </label>
      <label>
        <input type="radio" name="question1" value="火">
        🔥 人前で話したり、活発に動き回る
      </label>
      <label>
        <input type="radio" name="question1" value="土">
        🌍 継続的で安定した作業や、人をサポートする
      </label>
      <label>
        <input type="radio" name="question1" value="金">
        ⚡ 効率化や改善、質の向上に取り組む
      </label>
      <label>
        <input type="radio" name="question1" value="水">
        💧 状況に応じて柔軟に対応したり、情報を扱う
      </label>
    </div>
  </div>
  
  <!-- 質問2-4 同様 -->
  
  <button type="button" class="btn-prev">戻る</button>
  <button type="button" class="btn-next">次へ</button>
</div>

<!-- Step 3: 確認 -->
<div class="form-step" data-step="3" style="display:none;">
  <h2>入力内容の確認</h2>
  
  <div class="confirmation-summary">
    <!-- 入力内容の表示 -->
  </div>
  
  <button type="button" class="btn-prev">戻る</button>
  <button type="submit" class="btn-submit">診断を開始</button>
</div>
```

#### 6.4.2 プログレスバー
```html
<div class="progress-bar">
  <div class="progress-step active" data-step="1">
    <div class="step-number">1</div>
    <div class="step-label">基本情報</div>
  </div>
  <div class="progress-step" data-step="2">
    <div class="step-number">2</div>
    <div class="step-label">診断質問</div>
  </div>
  <div class="progress-step" data-step="3">
    <div class="step-number">3</div>
    <div class="step-label">確認</div>
  </div>
</div>
```

#### 6.4.3 ローディング画面
```html
<div class="loading-screen" style="display:none;">
  <div class="loading-animation">
    <div class="spinner"></div>
    <p>あなたの縁を分析しています...</p>
    <p class="loading-detail">60分類システムで計算中</p>
  </div>
</div>
```

#### 6.4.4 診断結果表示
```html
<div class="result-container" style="display:none;">
  <!-- ヘッダー -->
  <div class="result-header">
    <h1>あなたの縁診断結果</h1>
    <div class="natural-type-badge">
      <span class="element-icon">🌱</span>
      <span class="natural-type-text">木の春霞</span>
    </div>
  </div>
  
  <!-- 導入部 -->
  <section class="result-section introduction">
    <div class="section-content">
      <!-- 導入文 -->
    </div>
  </section>
  
  <!-- セクション1 -->
  <section class="result-section section-1">
    <h2>生まれ持った縁の本質</h2>
    <div class="section-content">
      <!-- 詳細内容 -->
    </div>
  </section>
  
  <!-- セクション2-6 同様 -->
  
  <!-- CTA -->
  <section class="cta-section">
    <h2>さらに詳しい診断結果を見る</h2>
    <p>完全版では18箇所のパワースポット情報と年間バイオリズムカレンダーをご覧いただけます。</p>
    <button class="btn-cta">完全版診断を見る（有料）</button>
  </section>
</div>
```

---

## 7. 実装フェーズ

### Phase 1: 基盤構築（1-2日）
```yaml
タスク:
  - プロジェクト初期設定
  - ファイル構成の作成
  - 基本HTML/CSSの実装
  - 定数データの準備

成果物:
  - 基本的なUIフレーム
  - カラーシステム適用
  - レスポンシブ対応
```

### Phase 2: 計算ロジック実装（2-3日）
```yaml
タスク:
  - 60分類計算関数
  - 名前音韻分析関数
  - 五行縁型判定関数
  - バイオリズム計算関数
  - 地域エネルギー計算関数
  - 単体テスト作成

成果物:
  - calculator.js完成
  - 全計算関数の動作確認
  - テストケース100%通過
```

### Phase 3: テンプレート作成（5-7日）
```yaml
タスク:
  - 60分類テンプレート作成
  - 各約5,000字（4,800-5,300字）×60
  - 品質チェック（火の朧月レベル v2.3）
  - 個人化ロジックの実装

成果物:
  - templates.js完成（全60テンプレート）
  - 個人化関数の実装
  - サンプル出力の確認
  
品質基準:
  - 文字数: 約5,000字（4,800-5,300字）
  - 構成: 3セクション+導入段落
  - 希少性表現: 完全禁止
  - 火の朧月レベルの品質
```

### Phase 4: フロントエンド統合（2-3日）
```yaml
タスク:
  - フォーム機能実装
  - バリデーション実装
  - 画面遷移制御
  - ローディングUI
  - 結果表示UI
  - エラーハンドリング

成果物:
  - app.js完成
  - 全画面の実装
  - スムーズな動作
```

### Phase 5: テスト・デバッグ（2-3日）
```yaml
タスク:
  - 統合テスト
  - ブラウザ互換性テスト
  - モバイル対応確認
  - パフォーマンス最適化
  - バグ修正

成果物:
  - バグゼロ
  - 全ブラウザ動作確認
  - モバイル完全対応
```

### Phase 6: デプロイ（1日）
```yaml
タスク:
  - Firebase Hosting設定
  - ビルド・デプロイ
  - 本番環境テスト
  - ドメイン設定

成果物:
  - 公開URL
  - 本番環境動作確認
```

**総所要時間: 13-19日**

---

## 8. 品質基準

### 8.1 機能品質
```yaml
必須要件:
  - 計算精度: 100%（検証済み）
  - エラー率: < 0.1%
  - 全入力パターン対応
  - バリデーション完全動作

推奨要件:
  - ローディング時間: < 3秒
  - レスポンス時間: < 1秒
  - UI応答性: < 200ms
```

### 8.2 コード品質
```yaml
必須:
  - コンソールエラー: 0件
  - JSエラー: 0件
  - 適切なコメント
  - 可読性の高いコード

推奨:
  - ESLint準拠
  - モジュール化
  - DRY原則
```

### 8.3 UX品質
```yaml
必須:
  - レスポンシブ対応
  - わかりやすいエラーメッセージ
  - 直感的な操作性
  - アクセシビリティ配慮

推奨:
  - アニメーション効果
  - ローディングフィードバック
  - 自動保存機能
```

### 8.4 テンプレート品質
```yaml
火の朧月レベル（v2.3基準）:
  - 文字数: 約5,000字（4,800-5,300字）
  - 希少性表現: 完全禁止
  - 個人性: その分類固有の特徴
  - 実用性: 具体的なアドバイス
  - 感情価値: 心に響く内容
  - 両対応表現: 自然に使用
  - 縁のベース概念: 適切に使用
  
  構成:
    1. 導入段落（200-300字）
    2. あなたの縁の本質（1,500字）
    3. 縁を活かす場所と人（1,500字）
    4. 今日からできること（1,000字）
```

---

## 9. 参照資料

### 9.1 プロジェクトドキュメント
```
- instruction_v312_fixed.md（システム指針）
- 01_sixty_classification_system.md（60分類システム）
- 02_position_weight_calculator_v2.js（12位置計算）
- 05_user_input_specification.md（入力仕様）
- 09_prefecture_database.json（都道府県DB）
- 10_region_energy_map.json（地域エネルギー）
- 火の朧月.md（テンプレート基準）
- 60_templates_quality_standards_v2.2.md（品質基準）
```

### 9.2 実装参考
```
- project_status_current_08192250.md（進捗状況）
- diagnosis_output_standards_v2_1.md（出力基準）
- chatgpt_diagnosis_creation_guide_v3_1.md（作成ガイド）
```

---

## 10. Claude Code実装指示

### 10.1 開始手順
```markdown
1. この要件定義書を完全に読み込む
2. プロジェクト構造を作成
3. Phase 1から順次実装
4. 各フェーズ完了後に動作確認
```

### 10.2 重要な実装ポイント
```yaml
計算ロジック:
  - 60分類計算は instruction_v312_fixed.md の仕様に100%準拠
  - 12位置マッピングは POSITION_MAPPING を使用
  - バイオリズムは10状態システムを正確に実装

テンプレート:
  - 火の朧月レベルを基準とする
  - 希少性表現は絶対に使用しない
  - 個人化率50-60%を確保
  - 文字数3,800-4,000字を厳守

UI/UX:
  - Tailwind CSS coreクラスのみ使用
  - モバイルファーストデザイン
  - 直感的な操作性
  - エラーメッセージは親切に
```

### 10.3 テスト項目
```yaml
単体テスト:
  - 各計算関数の精度
  - バリデーション動作
  - テンプレート選択ロジック

統合テスト:
  - フォーム送信→診断→結果表示
  - 全入力パターン
  - エラーケース

ブラウザテスト:
  - Chrome, Firefox, Safari, Edge
  - モバイルブラウザ
  - タブレット
```

### 10.4 デプロイ前チェックリスト
```yaml
□ 全機能が正常動作
□ コンソールエラー0件
□ モバイル完全対応
□ 全ブラウザ動作確認
□ パフォーマンス最適化完了
□ テンプレート60個完備
□ CTA動作確認
□ SEO対策（meta tags等）
```

---

## 補足資料

### A. サンプル診断フロー
```
ユーザー入力:
  birthDate: "1990-05-15"
  firstName: "Taro"
  lastName: "Yamada"
  birthPrefecture: "東京都"
  currentPrefecture: "神奈川県"
  question1: "木"
  question2: "火"
  question3: "土"
  question4: "水"

計算結果:
  naturalType: "金の彩雲"
  position: 3
  element: "金"
  phenomena: "彩雲"
  nameType: "広縁"
  attractionType: "木縁型"
  biorhythm: {
    currentState: "充実期",
    progress: 65
  }

出力:
  約5,000字（4,800-5,300字）の個人化された診断結果
  + 軽い補足情報（名前音韻、五行縁型、バイオリズム、地域エネルギー）
  + CTA（有料版への誘導）
```

### B. エラーケース例
```yaml
入力エラー:
  - 生年月日未来日 → "過去の日付を入力してください"
  - 名前空欄 → "名前を入力してください"
  - 都道府県未選択 → "都道府県を選択してください"

システムエラー:
  - テンプレート不足 → フォールバック処理
  - 計算エラー → エラーメッセージ表示
  - ネットワークエラー → リトライ提案
```

---

**要件定義書 v1.0 完成**  
**Claude Codeでの実装準備完了**

この要件定義書に基づいて実装を進めることで、統計学的根拠に基づいた高品質な縁パワースポット診断アプリケーションが完成します。
